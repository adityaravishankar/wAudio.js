/* wAudio.js v1.0.0 | (c) 2017, Aditya Ravi Shankar (www.adityaravishankar.com) | MIT License */
!function(){"use strict";if("undefined"==typeof window.AudioContext&&"undefined"==typeof window.webkitAudioContext)return void console.warn("No AudioContext found. wAudio will not be created.");var t=new(window.AudioContext||window.webkitAudioContext),e={},i=function(t){this._listeners={canplay:[],canplaythrough:[]},this.init(t)};i.playMutedSound=function(){var e=t.createOscillator(),i=t.createGain();i.gain.value=0,e.connect(i),i.connect(t.destination),e.start(),e.stop(t.currentTime+.001)},i.mobileAutoEnable=!1;var n=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(self._navigator&&self._navigator.userAgent),o=!!("ontouchend"in window||self._navigator&&self._navigator.maxTouchPoints>0||self._navigator&&self._navigator.msMaxTouchPoints>0);if(n&&o){var r=function(){i.mobileAutoEnable&&i.playMutedSound(),document.removeEventListener("touchend",r,!0)};document.addEventListener("touchend",r,!0)}i.prototype={_src:void 0,_buffer:void 0,get src(){return this._src},set src(t){this._src!==t&&(this._src=t,this._buffer=void 0,this._bufferSource=void 0,this._src&&this._loadAudio())},get currentSrc(){if(this._src&&!/^data:[^;]+;base64,/.test(this._src)){var t=document.createElement("a");return t.href=this._src,t.href}return this._src},_loadAudio:function(){var i=this._src,n=this;if(/^data:[^;]+;base64,/.test(i)){for(var o=atob(i.split(",")[1]),r=new Uint8Array(o.length),s=0;s<o.length;++s)r[s]=o.charCodeAt(s);var u=r.buffer;t.decodeAudioData(u,function(t){n._loadBuffer(t)})}else{if("file:"===document.location.protocol||/^file:/.test(i))throw"Cannot load audio from file:// URLs.";var c=new XMLHttpRequest;e[i]?e[i].buffer?setTimeout(function(){n._loadBuffer(e[i].buffer)},0):e[i].listeners.push(n):(e[i]={buffer:void 0,listeners:[n]},c.open("GET",i,!0),c.responseType="arraybuffer",c.onload=function(){var n=c.response;t.decodeAudioData(n,function(t){e[i].buffer=t;for(var n=e[i].listeners.length-1;n>=0;n--){var o=e[i].listeners[n];o._loadBuffer(t)}delete e[i].listeners})},c.send())}},_loadBuffer:function(t){this._buffer=t,this.dispatchEvent({type:"canplay",target:this}),this.dispatchEvent({type:"canplaythrough",target:this}),this._muted&&(this._volume=0),this._autoplay&&this.play()},get readyState(){return this._bufferSource?4:0},_autoplay:!1,get autoplay(){return this._autoplay},set autoplay(t){this._autoplay=!!t},_muted:!1,get muted(){return this._muted},set muted(t){this._muted=!!t},init:function(t){t&&(this.src=t),this._currentTime=0},_bufferSource:void 0,_gainNode:void 0,_playTime:void 0,_currentTime:0,get currentTime(){return this._bufferSource?this._currentTime+t.currentTime-this._playTime:this._currentTime},set currentTime(t){var e;this._bufferSource&&(e=!0,this.pause()),this._currentTime=t,e&&this.play()},_volume:1,get volume(){return this._volume},set volume(t){"number"==typeof t&&t>=0&&1>=t&&(this._volume=t,this._gainNode&&(this._gainNode.gain.value=this._volume))},get paused(){return void 0===this._bufferSource},play:function(){this._buffer&&!this._bufferSource?(this._bufferSource=t.createBufferSource(),this._gainNode=t.createGain(),this._gainNode.gain.value=this._volume,this._bufferSource.buffer=this._buffer,this._bufferSource.connect(this._gainNode),this._gainNode.connect(t.destination),this._playTime=t.currentTime,this._bufferSource.start(0,this._currentTime),this._bufferSource.onended=this._reset.bind(this)):this._src&&(this.autoplay=!0)},pause:function(){this._bufferSource&&(this._bufferSource.stop(0),this._currentTime+=t.currentTime-this._playTime,this._reset())},stop:function(){this._bufferSource&&(this._bufferSource.stop(0),this.reset(),this._currentTime=0)},_reset:function(){this._playTime=void 0,this._bufferSource=void 0,this._gainNode=void 0},addEventListener:function(t,e){if(!this._listeners.hasOwnProperty(t))throw"Invalid Event Type: "+t;this._listeners[t].push(e)},removeEventListener:function(t,e){if(!this._listeners.hasOwnProperty(t))throw"Invalid Event Type: "+t;for(var i=this._listeners[t].length-1;i>=0;i--)if(this._listeners[t][i]===e){this._listeners[t].splice(i,1);break}},dispatchEvent:function(t){var e=t.type;if(this._listeners.hasOwnProperty(e))for(var i=this._listeners[e].length-1;i>=0;i--)this._listeners[e][i](t)}},window.wAudio=i}();